<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Relat√≥rio DNS v9.19 - 20251211_220541</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-body: #0f172a;
            --bg-card: #1e293b;
            --bg-card-hover: #334155;
            --bg-header: #1e293b;
            --border-color: #334155;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --accent-primary: #3b82f6; 
            --accent-success: #10b981;
            --accent-warning: #f59e0b;
            --accent-danger: #ef4444;
            --accent-divergent: #d946ef;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-body);
            color: var(--text-primary);
            margin: 0;
            padding: 20px;
            line-height: 1.5;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        /* --- Header & Typography --- */
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--border-color);
        }
        
        h1 {
            font-size: 1.8rem;
            font-weight: 700;
            margin: 0;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 12px;
        }
        h1 small {
            font-size: 0.9rem;
            color: var(--text-secondary);
            font-weight: 400;
            background: var(--bg-card);
            padding: 4px 8px;
            border-radius: 6px;
        }

        h2 {
            font-size: 1.25rem;
            margin-top: 40px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            color: var(--text-primary);
            border-left: 4px solid var(--accent-primary);
            padding-left: 10px;
        }

        /* --- Dashboard Cards --- */
        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }
        .card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            position: relative;
            overflow: hidden;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            border-color: var(--bg-card-hover);
        }
        .card-num {
            font-size: 2.5rem;
            font-weight: 700;
            line-height: 1;
            margin-bottom: 5px;
        }
        .card-label {
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--text-secondary);
            font-weight: 600;
        }
        
        .st-total .card-num { color: var(--accent-primary); }
        .st-ok .card-num { color: var(--accent-success); }
        .st-warn .card-num { color: var(--accent-warning); }
        .st-fail .card-num { color: var(--accent-danger); }
        .st-div .card-num { color: var(--accent-divergent); }

        /* --- Nested Details Structure --- */
        details {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            margin-bottom: 10px;
            overflow: hidden;
            transition: all 0.2s ease;
        }
        
        /* Domain Level (Level 1) */
        details.domain-level {
            border-left: 4px solid var(--accent-primary);
        }
        details.domain-level[open] {
            margin-bottom: 20px;
        }
        details.domain-level > summary {
            background: var(--bg-card);
            padding: 15px 20px;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-primary);
        }
        details.domain-level > summary:hover {
            background: var(--bg-card-hover);
        }

        /* Group Level (Level 2) */
        details.group-level {
            margin: 10px 20px;
            background: rgba(0,0,0,0.2);
            border: 1px solid var(--border-color);
        }
        details.group-level > summary {
            padding: 10px 15px;
            font-size: 0.95rem;
            font-weight: 500;
            color: var(--text-secondary);
        }
        details.group-level > summary:hover {
            color: var(--text-primary);
            background: rgba(255,255,255,0.03);
        }

        summary {
            cursor: pointer;
            list-style: none;
            display: flex;
            align-items: center;
            justify-content: space-between;
            user-select: none;
        }
        summary::-webkit-details-marker { display: none; }
        summary::after {
            content: '+';
            font-size: 1.2rem;
            color: var(--text-secondary);
            font-weight: 300;
            margin-left: 10px;
        }
        details[open] > summary::after { content: '‚àí'; }

        /* --- Tables --- */
        .table-responsive {
            width: 100%;
            overflow-x: auto;
            border-top: 1px solid var(--border-color);
        }
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9rem;
        }
        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }
        th {
            background: rgba(0,0,0,0.3);
            color: var(--text-secondary);
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.75rem;
            letter-spacing: 0.05em;
        }
        td {
            font-family: 'Fira Code', monospace;
        }
        tr:hover td {
            background: rgba(255,255,255,0.02);
        }
        
        /* --- Badges & Status --- */
        .badge {
            display: inline-flex;
            align-items: center;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 600;
            font-family: 'Inter', sans-serif;
            text-transform: uppercase;
            letter-spacing: 0.02em;
        }
        .badge-type { background: rgba(59, 130, 246, 0.15); color: #60a5fa; border: 1px solid rgba(59, 130, 246, 0.3); }
        .badge.consistent { background: #1e293b; color: #94a3b8; border: 1px solid #334155; }
        
        .badge-mini {
            display: inline-block;
            width: 16px;
            height: 16px;
            text-align: center;
            line-height: 16px;
            border-radius: 4px;
            font-size: 9px;
            font-weight: bold;
            margin-right: 3px;
            color: #0f172a;
            vertical-align: middle;
            cursor: help;
        }
        .badge-mini.success { background-color: var(--accent-success); }
        .badge-mini.fail { background-color: var(--accent-danger); color: #fff; }
        .badge-mini.neutral { background-color: var(--text-secondary); opacity: 0.5; color: #000; }
                
        .status-cell { font-weight: 600; display: flex; align-items: center; gap: 8px; text-decoration: none; transition: opacity 0.2s; }
        .status-cell:hover { opacity: 0.8; }
        .st-ok { color: var(--accent-success); }
        .st-warn { color: var(--accent-warning); }
        .st-fail { color: var(--accent-danger); }
        .st-div { color: var(--accent-divergent); }
        
        /* Aliases for script usage */
        .status-ok { color: var(--accent-success) !important; }
        .status-warn { color: var(--accent-warning) !important; } /* Warning alias */
        .status-warning { color: var(--accent-warning) !important; }
        .status-fail { color: var(--accent-danger) !important; }
        .status-divergent { color: var(--accent-divergent) !important; }
        .status-neutral { color: var(--text-secondary) !important; }
        .time-val { font-size: 0.8em; color: var(--text-secondary); font-weight: 400; opacity: 0.7; }

        /* --- Modal & Logs --- */
        .modal {
            display: none; position: fixed; z-index: 2000; left: 0; top: 0; width: 100%; height: 100%;
            background-color: rgba(0,0,0,0.85); backdrop-filter: blur(4px);
        }
        .modal-content {
            background-color: var(--bg-card); margin: 5vh auto; padding: 0;
            border: 1px solid var(--border-color); width: 90%; max-width: 1200px;
            border-radius: 12px; box-shadow: 0 25px 50px -12px rgba(0,0,0,0.5);
            display: flex; flex-direction: column; max-height: 90vh;
        }
        .modal-header {
            padding: 20px; border-bottom: 1px solid var(--border-color);
            display: flex; justify-content: space-between; align-items: center;
        }
        .modal-body {
            padding: 0; overflow-y: auto; flex: 1;
            background: #000;
        }
        pre {
            margin: 0; padding: 20px; color: #e5e5e5; font-family: 'Fira Code', monospace; font-size: 0.85rem; line-height: 1.6;
        }
        
        /* --- Controls & Utilities --- */
        .tech-controls { display: flex; gap: 10px; margin-bottom: 20px; }
        .btn {
            background: var(--bg-card-hover); border: 1px solid var(--border-color);
            color: var(--text-primary); padding: 8px 16px; border-radius: 6px;
            cursor: pointer; font-family: 'Inter', sans-serif; font-size: 0.9rem;
            transition: all 0.2s;
        }
        .btn:hover { background: var(--accent-primary); border-color: var(--accent-primary); color: white; }
        
        .section-header { margin-top: 40px; margin-bottom: 20px; display: flex; align-items: center; justify-content: space-between; }
        
        /* Disclaimer */
        .disclaimer-box {
            background: rgba(245, 158, 11, 0.1); border: 1px solid rgba(245, 158, 11, 0.3);
            border-radius: 8px; padding: 15px; margin-bottom: 30px;
        }
        .disclaimer-box summary { color: var(--accent-warning); font-weight: 600; }
        
        /* Footer */
        footer { margin-top: 60px; padding-top: 20px; border-top: 1px solid var(--border-color); text-align: center; color: var(--text-secondary); font-size: 0.85rem; }
        footer a { color: var(--accent-primary); text-decoration: none; }
        
        /* Animations */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .dashboard, .domain-level { animation: fadeIn 0.4s ease-out forwards; }
    </style>
    <script>
        function toggleAll(level, state) {
            const selector = level === 'domain' ? 'details.domain-level' : 'details.group-level';
            document.querySelectorAll(selector).forEach(el => el.open = state);
        }
        
        function showLog(id) {
            var el = document.getElementById(id + '_content');
            if (!el) {
                alert("Detalhes t√©cnicos n√£o dispon√≠veis neste relat√≥rio simplificado.");
                return;
            }
            var rawContent = el.innerHTML;
            var titleEl = document.getElementById(id + '_title');
            var title = titleEl ? titleEl.innerText : 'Detalhes';
            
            document.getElementById('modalTitle').innerText = title;
            document.getElementById('modalText').innerHTML = rawContent;
            document.getElementById('logModal').style.display = "block";
            document.body.style.overflow = 'hidden'; 
        }
        
        function closeModal() {
            document.getElementById('logModal').style.display = "none";
            document.body.style.overflow = 'auto';
        }
        
        window.onclick = function(e) { if (e.target.className === 'modal') closeModal(); }
        document.addEventListener('keydown', function(e) { if(e.key === "Escape") closeModal(); });
    </script>
</head>
<body>
    <div class="container">
        <header>
            <h1>
                üîç Diagn√≥stico DNS
                <small>v9.19</small>
            </h1>
            <div style="text-align: right; color: var(--text-secondary); font-size: 0.9rem;">
                <div>Executado em: <strong>20251211_220541</strong></div>
                <div style="font-size: 0.8em; margin-top:4px;">Tempo Total: <span id="total_time_placeholder">...</span></div>
            </div>
        </header>
        <div style="background-color: rgba(59, 130, 246, 0.1); border: 1px solid rgba(59, 130, 246, 0.3); color: var(--text-primary); padding: 12px; border-radius: 8px; margin-bottom: 25px; display: flex; align-items: center; gap: 10px; font-size: 0.9rem;">
            <span style="font-size: 1.2rem;">‚ÑπÔ∏è</span>
            <div>
                <strong>Modo Simplificado Ativo:</strong> 
                Este relat√≥rio foi gerado em modo compacto. Logs t√©cnicos detalhados (outputs de dig, traceroute e ping) foram suprimidos para reduzir o tamanho do arquivo.
            </div>
        </div>
    <div id="logModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div id="modalTitle">Detalhes do Log</div>
                <span class="close-btn" onclick="closeModal()">&times;</span>
            </div>
            <div class="modal-body">
                <pre id="modalText"></pre>
            </div>
        </div>
    </div>
        <div class="dashboard">
            <div class="card st-total">
                <span class="card-num">2</span>
                <span class="card-label">Total Testes</span>
            </div>
            <div class="card st-ok">
                <span class="card-num">0</span>
                <span class="card-label">Sucesso (0%)</span>
            </div>
            <div class="card st-warn">
                <span class="card-num">0</span>
                <span class="card-label">Alertas</span>
            </div>
            <div class="card st-fail">
                <span class="card-num">0</span>
                <span class="card-label">Falhas Cr√≠ticas</span>
            </div>
            <div class="card st-div">
                <span class="card-num">2</span>
                <span class="card-label">Diverg√™ncias</span>
            </div>
        </div>
    
    <div class="dashboard" style="grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));">
            <div class="card" style="border-color: #3b82f6;">
                <span class="card-num" style="color: #60a5fa;">2 <small style="font-size:0.4em; color:#94a3b8;">/ 2</small></span>
                <span class="card-label">TCP Checks</span>
            </div>
            <div class="card" style="border-color: #8b5cf6;">
                <span class="card-num" style="color: #a78bfa;">0 <small style="font-size:0.4em; color:#94a3b8;">/ 2 / 2</small></span>
                <span class="card-label">DNSSEC Checks</span>
            </div>
        </div>
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 30px;">
        <div class="card" style="border-left: 4px solid var(--accent-primary);">
            <div style="display:flex; justify-content:space-between; align-items:center;">
                 <span class="card-label">Version Privacy</span>
                 <span style="font-size:1.5rem;">üïµÔ∏è</span>
            </div>
            <div style="margin-top:10px;">
                 <span style="font-weight:700; font-size:1.2rem; color:var(--text-primary);">6</span> <span style="font-size:0.85em; color:var(--accent-success);">Hidden</span>
                 <span style="color:#666;">/</span>
                 <span style="font-weight:700; font-size:1.2rem; color:var(--text-primary);">4</span> <span style="font-size:0.85em; color:var(--accent-danger);">Revealed</span>
            </div>
        </div>
        <div class="card" style="border-left: 4px solid var(--accent-warning);">
            <div style="display:flex; justify-content:space-between; align-items:center;">
                 <span class="card-label">Zone Transfer</span>
                 <span style="font-size:1.5rem;">üìÇ</span>
            </div>
            <div style="margin-top:10px;">
                 <span style="font-weight:700; font-size:1.2rem; color:var(--text-primary);">10</span> <span style="font-size:0.85em; color:var(--accent-success);">Denied</span>
                 <span style="color:#666;">/</span>
                 <span style="font-weight:700; font-size:1.2rem; color:var(--text-primary);">0</span> <span style="font-size:0.85em; color:var(--accent-danger);">Allowed</span>
            </div>
        </div>
        <div class="card" style="border-left: 4px solid var(--accent-danger);">
             <div style="display:flex; justify-content:space-between; align-items:center;">
                 <span class="card-label">Recursion</span>
                 <span style="font-size:1.5rem;">üîÑ</span>
            </div>
            <div style="margin-top:10px;">
                 <span style="font-weight:700; font-size:1.2rem; color:var(--text-primary);">2</span> <span style="font-size:0.85em; color:var(--accent-success);">Closed</span>
                 <span style="color:#666;">/</span>
                 <span style="font-weight:700; font-size:1.2rem; color:var(--text-primary);">8</span> <span style="font-size:0.85em; color:var(--accent-danger);">Open</span>
            </div>
        </div>
    </div>
        <details class="disclaimer-details">
            <summary class="disclaimer-summary">‚ö†Ô∏è AVISO DE ISEN√á√ÉO DE RESPONSABILIDADE (CLIQUE PARA EXPANDIR) ‚ö†Ô∏è</summary>
            <div class="disclaimer-content">
                Este relat√≥rio reflete apenas o que <strong>sobreviveu</strong> √† viagem de volta para este script, e n√£o necessariamente a Verdade Absoluta do Universo‚Ñ¢.<br>
                Lembre-se que entre o seu terminal e o servidor DNS existe uma selva hostil habitada por:
                <ul>
                    <li><strong>Firewalls Paranoicos:</strong> Que bloqueiam at√© pensamento positivo (e pacotes UDP leg√≠timos).</li>
                    <li><strong>Middleboxes Criativos:</strong> Filtros de seguran√ßa que acham que sua query DNS √© um ataque nuclear.</li>
                    <li><strong>Rate Limits:</strong> Porque ningu√©m gosta de <em>spam</em>, nem mesmo o servidor.</li>
                    <li><strong>Balanceamento de Carga:</strong> Onde servidores diferentes respondem com humores diferentes.</li>
                </ul>
                
                <hr style="border: 0; border-top: 1px solid #ffcc02; margin: 15px 0;">
                
                <strong>üßê CRIT√âRIOS DE DIVERG√äNCIA ATIVOS (v9.19):</strong><br>
                Al√©m dos erros padr√µes, este relat√≥rio aplicou as seguintes regras de consist√™ncia (3 tentativas):
                <div class="criteria-legend">
                    <div class="criteria-item">Strict IP Check: <span class="crit-false">false</span> (True = Requer mesmo IP sempre)</div>
                    <div class="criteria-item">Strict Order Check: <span class="crit-false">false</span> (True = Requer mesma ordem)</div>
                    <div class="criteria-item">Strict TTL Check: <span class="crit-false">false</span> (True = Requer mesmo TTL)</div>
                </div>
                <div style="margin-top:5px; font-size:0.85em; font-style:italic;">
                    (Se <strong>false</strong>, varia√ß√µes no campo foram ignoradas para evitar diverg√™ncias irrelevantes em cen√°rios din√¢micos).
                </div>
            </div>
        </details>
<details class="domain-level"><summary>üåê wikipedia.org <span style="font-size:0.85em; margin-left:15px; font-weight:normal; opacity:0.9;">Tests: <strong>2</strong> | <span class="st-div">üîÄ 2</span></span> <span style="font-size:0.8em; color:var(--text-secondary); margin-left:10px;">[Recs: soa]</span> <span class="badge" style="margin-left:auto">recursive</span></summary>
<details class="group-level"><summary>üìÇ Grupo: QUAD9 <span style="font-size:0.85em; margin-left:10px; font-weight:normal; opacity:0.9;">Total: <strong>2</strong> | <span class="st-div">üîÄ 2</span></span></summary>
<div class="table-responsive"><table><thead><tr><th style="width:30%">Target (Record)</th>
<th>9.9.9.9</th>
<th>149.112.112.112</th>
</tr></thead><tbody>
<tr><td><span class="badge badge-type">recursive</span> <strong>wikipedia.org</strong> <span style="color:var(--text-secondary)">(soa)</span></td>
<td><div class="status-cell status-divergent">üîÄ DIV <span class="consistency-badge consistency-bad">1/3</span> <div style='margin-top:2px;'> <a href='#' onclick="showLog('tcp_9_9_9_9_wikipedia_org'); return false;"><span class='badge-mini success' title='TCP OK'>T</span></a> <a href='#' onclick="showLog('sec_9_9_9_9_wikipedia_org'); return false;"><span class='badge-mini neutral' title='DNSSEC Unsigned'>D</span></a> <span class="time-val" style='margin-left:4px'>42ms</span></div></div></td>
<td><div class="status-cell status-divergent">üîÄ DIV <span class="consistency-badge consistency-bad">1/3</span> <div style='margin-top:2px;'> <a href='#' onclick="showLog('tcp_149_112_112_112_wikipedia_org'); return false;"><span class='badge-mini success' title='TCP OK'>T</span></a> <a href='#' onclick="showLog('sec_149_112_112_112_wikipedia_org'); return false;"><span class='badge-mini neutral' title='DNSSEC Unsigned'>D</span></a> <span class="time-val" style='margin-left:4px'>40ms</span></div></div></td>
</tr>
</tbody></table></div>
</details>
</details>
    <div style="display:flex; justify-content:flex-end; margin-bottom: 20px;">
        <div class="tech-controls">
            <button class="btn" onclick="toggleAll('domain', true)">‚ûï Expandir Dom√≠nios</button>
            <button class="btn" onclick="toggleAll('domain', false)">‚ûñ Recolher Dom√≠nios</button>
            <button class="btn" onclick="toggleAll('group', true)">‚ûï Expandir Grupos</button>
            <button class="btn" onclick="toggleAll('group', false)">‚ûñ Recolher Grupos</button>
        </div>
    </div>
        <details class="section-details" style="margin-top: 30px; border-left: 4px solid var(--accent-warning);">
             <summary style="font-size: 1.1rem; font-weight: 600;">üì° Lat√™ncia e Disponibilidade (ICMP)</summary>
             <div class="table-responsive" style="padding:15px;">
             <table><thead><tr><th>Grupo</th><th>Servidor</th><th>Status</th><th>Perda (%)</th><th>Lat√™ncia M√©dia</th></tr></thead><tbody>
<tr><td><span class="badge">[GOOGLE]</span></td><td><strong>8.8.8.8</strong></td><td class="status-ok">‚úÖ UP</td><td>0%</td><td>9.391ms</td></tr>
<tr><td><span class="badge">[GOOGLE]</span></td><td><strong>8.8.4.4</strong></td><td class="status-ok">‚úÖ UP</td><td>0%</td><td>9.709ms</td></tr>
<tr><td><span class="badge">[OPENDNS]</span></td><td><strong>208.67.222.222</strong></td><td class="status-ok">‚úÖ UP</td><td>0%</td><td>11.838ms</td></tr>
<tr><td><span class="badge">[OPENDNS]</span></td><td><strong>208.67.220.220</strong></td><td class="status-ok">‚úÖ UP</td><td>0%</td><td>11.816ms</td></tr>
<tr><td><span class="badge">[ROOT_SERVERS]</span></td><td><strong>198.41.0.4</strong></td><td class="status-ok">‚úÖ UP</td><td>0%</td><td>124.235ms</td></tr>
<tr><td><span class="badge">[ROOT_SERVERS]</span></td><td><strong>192.58.128.30</strong></td><td class="status-ok">‚úÖ UP</td><td>0%</td><td>14.176ms</td></tr>
<tr><td><span class="badge">[QUAD9]</span></td><td><strong>9.9.9.9</strong></td><td class="status-ok">‚úÖ UP</td><td>0%</td><td>11.609ms</td></tr>
<tr><td><span class="badge">[QUAD9]</span></td><td><strong>149.112.112.112</strong></td><td class="status-ok">‚úÖ UP</td><td>0%</td><td>11.389ms</td></tr>
<tr><td><span class="badge">[CLOUDFLARE]</span></td><td><strong>1.1.1.1</strong></td><td class="status-ok">‚úÖ UP</td><td>0%</td><td>11.652ms</td></tr>
<tr><td><span class="badge">[CLOUDFLARE]</span></td><td><strong>1.0.0.1</strong></td><td class="status-ok">‚úÖ UP</td><td>0%</td><td>12.302ms</td></tr>
</tbody></table></div></details>
        <details class="section-details" style="margin-top: 20px; border-left: 4px solid var(--accent-danger);">
             <summary style="font-size: 1.1rem; font-weight: 600;">üõ°Ô∏è An√°lise de Seguran√ßa & Riscos</summary>
             <div class="table-responsive" style="padding:15px;">
             <table>
                <thead>
                    <tr>
                        <th>Servidor</th>
                        <th>Vers√£o (Privacy)</th>
                        <th>AXFR (Zone Transfer)</th>
                        <th>Recurs√£o (Open Relay)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td><strong>8.8.8.8</strong></td><td><a href="#" onclick="showLog('sec_ver_8_8_8_8'); return false;" class="status-cell"><span class="badge status-ok">HIDDEN (OK)</span></a></td><td><a href="#" onclick="showLog('sec_axfr_8_8_8_8'); return false;" class="status-cell"><span class="badge status-ok">DENIED (OK)</span></a></td><td><a href="#" onclick="showLog('sec_rec_8_8_8_8'); return false;" class="status-cell"><span class="badge status-fail">OPEN (RISK)</span></a></td></tr>
<tr><td><strong>8.8.4.4</strong></td><td><a href="#" onclick="showLog('sec_ver_8_8_4_4'); return false;" class="status-cell"><span class="badge status-ok">HIDDEN (OK)</span></a></td><td><a href="#" onclick="showLog('sec_axfr_8_8_4_4'); return false;" class="status-cell"><span class="badge status-ok">DENIED (OK)</span></a></td><td><a href="#" onclick="showLog('sec_rec_8_8_4_4'); return false;" class="status-cell"><span class="badge status-fail">OPEN (RISK)</span></a></td></tr>
<tr><td><strong>208.67.222.222</strong></td><td><a href="#" onclick="showLog('sec_ver_208_67_222_222'); return false;" class="status-cell"><span class="badge status-ok">HIDDEN (OK)</span></a></td><td><a href="#" onclick="showLog('sec_axfr_208_67_222_222'); return false;" class="status-cell"><span class="badge status-ok">DENIED (OK)</span></a></td><td><a href="#" onclick="showLog('sec_rec_208_67_222_222'); return false;" class="status-cell"><span class="badge status-fail">OPEN (RISK)</span></a></td></tr>
<tr><td><strong>208.67.220.220</strong></td><td><a href="#" onclick="showLog('sec_ver_208_67_220_220'); return false;" class="status-cell"><span class="badge status-ok">HIDDEN (OK)</span></a></td><td><a href="#" onclick="showLog('sec_axfr_208_67_220_220'); return false;" class="status-cell"><span class="badge status-ok">DENIED (OK)</span></a></td><td><a href="#" onclick="showLog('sec_rec_208_67_220_220'); return false;" class="status-cell"><span class="badge status-fail">OPEN (RISK)</span></a></td></tr>
<tr><td><strong>198.41.0.4</strong></td><td><a href="#" onclick="showLog('sec_ver_198_41_0_4'); return false;" class="status-cell"><span class="badge status-fail">REVEALED: ATLAS...</span></a></td><td><a href="#" onclick="showLog('sec_axfr_198_41_0_4'); return false;" class="status-cell"><span class="badge status-ok">DENIED (OK)</span></a></td><td><a href="#" onclick="showLog('sec_rec_198_41_0_4'); return false;" class="status-cell"><span class="badge status-ok">CLOSED (OK)</span></a></td></tr>
<tr><td><strong>192.58.128.30</strong></td><td><a href="#" onclick="showLog('sec_ver_192_58_128_30'); return false;" class="status-cell"><span class="badge status-fail">REVEALED: NSD...</span></a></td><td><a href="#" onclick="showLog('sec_axfr_192_58_128_30'); return false;" class="status-cell"><span class="badge status-ok">DENIED (OK)</span></a></td><td><a href="#" onclick="showLog('sec_rec_192_58_128_30'); return false;" class="status-cell"><span class="badge status-ok">CLOSED (OK)</span></a></td></tr>
<tr><td><strong>9.9.9.9</strong></td><td><a href="#" onclick="showLog('sec_ver_9_9_9_9'); return false;" class="status-cell"><span class="badge status-fail">REVEALED: Q9-P-7.6...</span></a></td><td><a href="#" onclick="showLog('sec_axfr_9_9_9_9'); return false;" class="status-cell"><span class="badge status-ok">DENIED (OK)</span></a></td><td><a href="#" onclick="showLog('sec_rec_9_9_9_9'); return false;" class="status-cell"><span class="badge status-fail">OPEN (RISK)</span></a></td></tr>
<tr><td><strong>149.112.112.112</strong></td><td><a href="#" onclick="showLog('sec_ver_149_112_112_112'); return false;" class="status-cell"><span class="badge status-fail">REVEALED: Q9-P-7.6...</span></a></td><td><a href="#" onclick="showLog('sec_axfr_149_112_112_112'); return false;" class="status-cell"><span class="badge status-ok">DENIED (OK)</span></a></td><td><a href="#" onclick="showLog('sec_rec_149_112_112_112'); return false;" class="status-cell"><span class="badge status-fail">OPEN (RISK)</span></a></td></tr>
<tr><td><strong>1.1.1.1</strong></td><td><a href="#" onclick="showLog('sec_ver_1_1_1_1'); return false;" class="status-cell"><span class="badge status-ok">HIDDEN (OK)</span></a></td><td><a href="#" onclick="showLog('sec_axfr_1_1_1_1'); return false;" class="status-cell"><span class="badge status-ok">DENIED (OK)</span></a></td><td><a href="#" onclick="showLog('sec_rec_1_1_1_1'); return false;" class="status-cell"><span class="badge status-fail">OPEN (RISK)</span></a></td></tr>
<tr><td><strong>1.0.0.1</strong></td><td><a href="#" onclick="showLog('sec_ver_1_0_0_1'); return false;" class="status-cell"><span class="badge status-ok">HIDDEN (OK)</span></a></td><td><a href="#" onclick="showLog('sec_axfr_1_0_0_1'); return false;" class="status-cell"><span class="badge status-ok">DENIED (OK)</span></a></td><td><a href="#" onclick="showLog('sec_rec_1_0_0_1'); return false;" class="status-cell"><span class="badge status-fail">OPEN (RISK)</span></a></td></tr>
                </tbody>
             </table>
             </div>
        </details>
        <details class="section-details" style="margin-top: 20px; border-left: 4px solid var(--accent-divergent);">
             <summary style="font-size: 1.1rem; font-weight: 600;">üõ§Ô∏è Rota de Rede (Traceroute)</summary>
             <div class="table-responsive" style="padding:15px;">
<table><thead><tr><th>Grupo</th><th>Servidor</th><th>Hops</th><th>Caminho (Resumo)</th></tr></thead><tbody>
<tr><td><span class="badge">[GOOGLE]</span></td><td><strong>8.8.8.8</strong></td><td>15</td><td><span style="font-size:0.85em; color:#888;">15 *</span></td></tr>
<tr><td><span class="badge">[GOOGLE]</span></td><td><strong>8.8.4.4</strong></td><td>15</td><td><span style="font-size:0.85em; color:#888;">15 *</span></td></tr>
<tr><td><span class="badge">[OPENDNS]</span></td><td><strong>208.67.222.222</strong></td><td>15</td><td><span style="font-size:0.85em; color:#888;">15 *</span></td></tr>
<tr><td><span class="badge">[OPENDNS]</span></td><td><strong>208.67.220.220</strong></td><td>15</td><td><span style="font-size:0.85em; color:#888;">15 *</span></td></tr>
<tr><td><span class="badge">[ROOT_SERVERS]</span></td><td><strong>198.41.0.4</strong></td><td>15</td><td><span style="font-size:0.85em; color:#888;">15 *</span></td></tr>
<tr><td><span class="badge">[ROOT_SERVERS]</span></td><td><strong>192.58.128.30</strong></td><td>15</td><td><span style="font-size:0.85em; color:#888;">15 *</span></td></tr>
<tr><td><span class="badge">[QUAD9]</span></td><td><strong>9.9.9.9</strong></td><td>15</td><td><span style="font-size:0.85em; color:#888;">15 *</span></td></tr>
<tr><td><span class="badge">[QUAD9]</span></td><td><strong>149.112.112.112</strong></td><td>15</td><td><span style="font-size:0.85em; color:#888;">15 *</span></td></tr>
<tr><td><span class="badge">[CLOUDFLARE]</span></td><td><strong>1.1.1.1</strong></td><td>15</td><td><span style="font-size:0.85em; color:#888;">15 *</span></td></tr>
<tr><td><span class="badge">[CLOUDFLARE]</span></td><td><strong>1.0.0.1</strong></td><td>15</td><td><span style="font-size:0.85em; color:#888;">15 *</span></td></tr>
</tbody></table>
</div></details>
        <details class="section-details" style="margin-top: 20px; border-left: 4px solid var(--accent-primary);">
            <summary style="font-size: 1.1rem; font-weight: 600;">üìã Testes DNS TCP e DNS SEC</summary>
            <div style="padding: 20px;">
                <p style="color:var(--text-secondary); margin-bottom:15px; font-size:0.9rem;">
                    Valida√ß√£o de recursos avan√ßados (Transporte TCP e Assinatura DNSSEC) para cada servidor consultado.
                </p>
                <div class="table-responsive">
                    <table>
                        <thead>
                            <tr>
                                <th>Alvo Check</th>
                                <th>Servidor</th>
                                <th>TCP Status</th>
                                <th>DNSSEC Status</th>
                            </tr>
                        </thead>
                        <tbody>
<tr><td><strong>wikipedia.org</strong> (recursive)</td><td>QUAD9 / 9.9.9.9</td><td><a href='#' onclick="showLog('tcp_9_9_9_9_wikipedia_org'); return false;"><span class='badge-mini success'>OK</span></a></td><td><a href='#' onclick="showLog('sec_9_9_9_9_wikipedia_org'); return false;"><span class='badge-mini neutral'>ABS</span></a></td></tr>
<tr><td><strong>wikipedia.org</strong> (recursive)</td><td>QUAD9 / 149.112.112.112</td><td><a href='#' onclick="showLog('tcp_149_112_112_112_wikipedia_org'); return false;"><span class='badge-mini success'>OK</span></a></td><td><a href='#' onclick="showLog('sec_149_112_112_112_wikipedia_org'); return false;"><span class='badge-mini neutral'>ABS</span></a></td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </details>
        <div style="display:none;">
</div>
        <details class="section-details" style="margin-top: 30px; border-left: 4px solid #6b7280;">
             <summary style="font-size: 1.1rem; font-weight: 600;">‚öôÔ∏è Bastidores da Execu√ß√£o (Invent√°rio & Configs)</summary>
             <div style="padding:15px;">
                 <p style="color: #808080; margin-bottom: 20px;">Par√¢metros t√©cnicos utilizados nesta bateria de testes.</p>
                 
                 <div class="table-responsive">
                 <table>
                    <thead>
                        <tr>
                            <th>Par√¢metro</th>
                            <th>Valor Configurado</th>
                            <th>Descri√ß√£o / Fun√ß√£o</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>Vers√£o do Script</td><td>v9.19</td><td>Identifica√ß√£o da release utilizada.</td></tr>
                        <tr><td>Timeout Global</td><td>4s</td><td>Tempo m√°ximo de espera por resposta do DNS.</td></tr>
                        <tr><td>Sleep (Intervalo)</td><td>0.05s</td><td>Pausa entre tentativas consecutivas (consistency check).</td></tr>
                        <tr><td>Valida Conectividade</td><td>true</td><td>Testa porta 53 antes do envio da query.</td></tr>
                        <tr><td>Check BIND Version</td><td>true</td><td>Consulta caos class para vers√£o do BIND.</td></tr>
                        <tr><td>Ping Enabled</td><td>true</td><td>Verifica√ß√£o de lat√™ncia ICMP (Count: 3, Timeout: 4s).</td></tr>
                        <tr><td>TCP Check (+tcp)</td><td>true</td><td>Obrigatoriedade de suporte a DNS via TCP.</td></tr>
                        <tr><td>DNSSEC Check (+dnssec)</td><td>true</td><td>Valida√ß√£o da cadeia de confian√ßa DNSSEC.</td></tr>
                        <tr><td>Trace Route Check</td><td>true</td><td>Mapeamento de rota at√© o servidor.</td></tr>
                        <tr><td>Consistency Checks</td><td>3 tentativas</td><td>Repeti√ß√µes para validar estabilidade da resposta.</td></tr>
                        <tr><td>Strict Criteria</td><td>IP=false | Order=false | TTL=false</td><td>Regras r√≠gidas para considerar diverg√™ncia.</td></tr>
                        <tr><td>Iterative DIG Options</td><td>+norecurse +tries=1 +nocookie +cd +bufsize=1232 +nsid</td><td>Flags RAW enviadas ao DIG (Modo Iterativo).</td></tr>
                        <tr><td>Recursive DIG Options</td><td>+tries=1 +nocookie +cd +bufsize=1232 +nsid</td><td>Flags RAW enviadas ao DIG (Modo Recursivo).</td></tr>
                        <tr><td>Latency Threshold</td><td>100ms</td><td>Acima deste valor, a resposta √© marcada como 'Slow' (Alerta).</td></tr>
                        <tr><td>Packet Loss Limit</td><td>5%</td><td>Toler√¢ncia m√°xima de perda de pacotes antes de falhar o teste.</td></tr>
                        <tr><td>Color Output</td><td>true</td><td>Indica se a sa√≠da do terminal utiliza c√≥digos de cores ANSI.</td></tr>
                    </tbody>
                 </table>
                 </div>
                 
                 <!-- Config Files Dump -->
                 <h3 style="margin-top:30px; font-size:1rem; color:var(--text-secondary); border-bottom:1px solid #334155; padding-bottom:5px;">üìÇ Arquivo de Dom√≠nios (debug_domains.csv)</h3>
                 <div class="table-responsive">
                     <table>
                        <thead><tr><th>Dom√≠nio</th><th>Grupos</th><th>Tipos Teste</th><th>Records</th><th>Hosts Extras</th></tr></thead>
                        <tbody>
<tr><td colspan='5'>Arquivo n√£o encontrado.</td></tr>
                        </tbody>
                     </table>
                 </div>

                 <h3 style="margin-top:30px; font-size:1rem; color:var(--text-secondary); border-bottom:1px solid #334155; padding-bottom:5px;">üìÇ Arquivo de Grupos DNS (dns_groups.csv)</h3>
                 <div class="table-responsive">
                     <table>
                        <thead><tr><th>Nome Grupo</th><th>Descri√ß√£o</th><th>Tipo</th><th>Timeout</th><th>Servidores</th></tr></thead>
                        <tbody>
<tr><td>GOOGLE</td><td>Google Public DNS</td><td>recursive</td><td>2</td><td>8.8.8.8,8.8.4.4</td></tr>
<tr><td>CLOUDFLARE</td><td>Cloudflare DNS</td><td>recursive</td><td>2</td><td>1.1.1.1,1.0.0.1</td></tr>
<tr><td>QUAD9</td><td>Quad9 Security DNS</td><td>recursive</td><td>3</td><td>9.9.9.9,149.112.112.112</td></tr>
<tr><td>OPENDNS</td><td>Cisco OpenDNS</td><td>recursive</td><td>3</td><td>208.67.222.222,208.67.220.220</td></tr>
<tr><td>ROOT_SERVERS</td><td>Root Servers (Letra A e J)</td><td>authoritative</td><td>5</td><td>198.41.0.4,192.58.128.30</td></tr>
                        </tbody>
                     </table>
                 </div>

             </div>
        </details>
        <div class="timing-container" style="display:flex; justify-content:center; gap:30px; margin: 40px auto 20px auto; padding: 15px; background:var(--bg-secondary); border-radius:12px; max-width:800px; border:1px solid var(--border-color);">
            <div class="timing-item" style="text-align:center;">
                <div style="font-size:0.8rem; color:var(--text-secondary); text-transform:uppercase; letter-spacing:1px;">In√≠cio</div>
                <div style="font-size:1.1rem; font-weight:600;">11/12/2025 22:05:41</div>
            </div>
            <div class="timing-item" style="text-align:center;">
                <div style="font-size:0.8rem; color:var(--text-secondary); text-transform:uppercase; letter-spacing:1px;">Final</div>
                <div style="font-size:1.1rem; font-weight:600;">11/12/2025 22:06:45</div>
            </div>
            <div class="timing-item" style="text-align:center;">
                <div style="font-size:0.8rem; color:var(--text-secondary); text-transform:uppercase; letter-spacing:1px;">Tentativas</div>
                <div style="font-size:1.1rem; font-weight:600;">3x</div>
            </div>
            <div class="timing-item" style="text-align:center;">
                <div style="font-size:0.8rem; color:var(--text-secondary); text-transform:uppercase; letter-spacing:1px;">Dura√ß√£o</div>
                <div style="font-size:1.1rem; font-weight:600;"><span id="total_time_footer">64s</span></div>
            </div>
        </div>
        <details class="section-details" style="margin-top: 40px; border-left: 4px solid #64748b;">
            <summary style="font-size: 1.1rem; font-weight: 600;">üìö Manual de Refer√™ncia (Help)</summary>
            <div class="modal-body" style="background: #1e293b; color: #cbd5e1; padding: 20px; font-family: 'Fira Code', monospace; font-size: 0.85rem; overflow-x: auto;">
                <pre style="white-space: pre-wrap;">[H[2J[3J==============================================================================
       üîç DIAGN√ìSTICO DNS AVAN√áADO - MANUAL DE REFER√äNCIA v9.19        
==============================================================================

DESCRI√á√ÉO GERAL:
  Esta ferramenta √© um auditor de infraestrutura DNS projetado para validar a
  confiabilidade, consist√™ncia e performance de servidores autoritativos e recursivos.

  O script executa uma bateria de testes para cada dom√≠nio alvo contra um grupo de
  servidores DNS definidos, identificando:
   1. Disponibilidade: Se os servidores est√£o alcan√ß√°veis (ICMP/TCP).
   2. Consist√™ncia: Se m√∫ltiplos servidores retornam a mesma resposta (SOAs, IPs).
   3. Estabilidade: Se a resposta varia ao longo de m√∫ltiplas consultas (Flapping).
   4. Features: Suporte a TCP (obrigat√≥rio RFC 7766) e valida√ß√£o DNSSEC.
   5. Performance: Lat√™ncia de resposta e perda de pacotes.
   6. Seguran√ßa: Transfer√™ncia de Zona (AXFR), Recurs√£o Aberta e Vers√£o BIND.

MODOS DE OPERA√á√ÉO:
  Modo Interativo (Padr√£o): Um wizard guia a configura√ß√£o das vari√°veis antes do in√≠cio.
  Modo Silencioso (-y): Executa imediatamente usando os valores padr√£o ou editados no script.

OP√á√ïES DE LINHA DE COMANDO:
  -n &lt;arquivo&gt;   Define arquivo CSV de dom√≠nios (Padr√£o: domains_tests.csv)
  -g &lt;arquivo&gt;   Define arquivo CSV de grupos DNS (Padr√£o: dns_groups.csv)
  -y            Bypassa o menu interativo (Non-interactive/Batch execution).
  -s            Modo Simplificado (Gera HTML sem logs t√©cnicos para redu√ß√£o de tamanho).
  -j            Gera sa√≠da em JSON estruturado (.json).
  -t            Habilita testes de conectividade TCP.
  -d            Habilita valida√ß√£o DNSSEC.
  -x            Habilita teste de transfer√™ncia de zona (AXFR).
  -r            Habilita teste de recurs√£o aberta.
  -h            Exibe este manual detalhado.

DICION√ÅRIO DE VARI√ÅVEIS (Configura√ß√£o Fina):
  Abaixo est√£o as vari√°veis que controlam o comportamento do motor de testes.
  Elas podem ser ajustadas editando o cabe√ßalho do script ou via menu interativo.

  TIMEOUT
      Define o tempo m√°ximo (em segundos) que o script aguarda por respostas de rede.
      Afeta pings, traceroutes e consultas DIG. Default seguro: 4s.

  CONSISTENCY_CHECKS (Padr√£o: 10)
      Define quantas vezes a MESMA consulta ser√° repetida para o MESMO servidor.
      Se o servidor responder IPs diferentes nessas N tentativas, ele √© marcado como
      DIVERGENTE (~). Isso pega balanceamentos Round-Robin mal configurados.

  SLEEP (Padr√£o: 0.05s)
      Pausa entre cada tentativa do loop de consist√™ncia. Aumente se o firewall
      do alvo estiver bloqueando as requisi√ß√µes por rate-limit.

  STRICT_IP_CHECK (true/false)
      true: Exige que o IP de resposta seja ID√äNTICO em todas as tentativas.
      false: Aceita IPs diferentes (√∫til para CDNs ou pools de balanceamento).

  STRICT_ORDER_CHECK (true/false)
      true: A ordem dos registros (ex: NS1 antes de NS2) deve ser id√™ntica.
      false: A ordem √© ignorada, desde que o conte√∫do seja o mesmo.

  STRICT_TTL_CHECK (true/false)
      true: Considera erro se o TTL mudar entre consultas (ex: 300 -&gt; 299).
      false: Ignora varia√ß√µes de TTL (Comportamento recomendado para recursivos).

  ENABLE_PING / PING_COUNT / PING_TIMEOUT
      M√≥dulo de lat√™ncia ICMP. Executa N pings antes dos testes DNS para verificar
      a sa√∫de b√°sica da rota e perda de pacotes.

  CHECK_BIND_VERSION
      Tenta extrair a vers√£o do software DNS usando consultas CHAOS TXT.
      (Geralmente bloqueado por seguran√ßa em servidores de produ√ß√£o).

  ENABLE_TCP_CHECK / ENABLE_DNSSEC_CHECK
      Ativa verifica√ß√µes de conformidade RFC 7766 (TCP) e suporte a DNSSEC.

  ENABLE_AXFR_CHECK / ENABLE_RECURSION_CHECK
      Testes de seguran√ßa para permissividade de transfer√™ncia de zona e recurs√£o.
      
  ENABLE_SOA_SERIAL_CHECK
      Verifica se os n√∫meros de s√©rie SOA s√£o id√™nticos entre todos os servidores do grupo.

  LATENCY_WARNING_THRESHOLD (Default: 100ms)
      Define o limiar para alertas amarelos de lentid√£o.

  PING_PACKET_LOSS_LIMIT (Default: 10%)
      Define a porcentagem aceit√°vel de perda de pacotes antes de marcar como UNSTABLE.

  COLOR_OUTPUT (true/false)
      Habilita ou desabilita cores no terminal ANSI.

LEGENDA DE SA√çDA (O que significam os s√≠mbolos?):
  . (Ponto)      = Sucesso (Resposta consistente e v√°lida).
  ! (Exclama√ß√£o)= Alerta (Sucesso, mas servidor lento ou resposta estranha).
  ~ (Til)       = Diverg√™ncia (O servidor mudou a resposta durante o teste).
  x (Xis)        = Falha Cr√≠tica (Timeout, Erro de Conex√£o, REFUSED).
  T / T        = Status do Teste TCP (Falha/Sucesso).
  D / D / D    = Status do Teste DNSSEC (Falha/Sucesso/Ausente).

  --- LEGENDAS DE SEGURAN√áA ---
  HIDDEN/DENIED/CLOSED = Seguro (OK)
  REVEALED/ALLOWED/OPEN = Risco (Falha de Seguran√ßa)
  TIMEOUT/ERROR       = Erro de Rede (Inconclusivo)

==============================================================================</pre>
            </div>
        </details>
        <footer>
            Gerado automaticamente por <strong>DNS Diagnostic Tool (v9.19)</strong><br>
        </footer>
    </div>
    <a href="#top" style="position:fixed; bottom:20px; right:20px; background:var(--accent-primary); color:white; width:40px; height:40px; border-radius:50%; display:flex; align-items:center; justify-content:center; text-decoration:none; box-shadow:0 4px 10px rgba(0,0,0,0.3); font-size:1.2rem;">‚¨ÜÔ∏è</a>
    <script>
        document.getElementById('total_time_placeholder').innerText = "64s";
    </script>
</body>
</html>
